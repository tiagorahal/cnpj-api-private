<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Painel de Usuários</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css">
    <style>
      body { background-color: #18181b; }
      .dataTables_wrapper .dataTables_filter input {
          color: #e5e7eb; background: #27272a; border: 1px solid #3f3f46;
      }
      .dataTables_wrapper .dataTables_length select {
          color: #e5e7eb; background: #27272a; border: 1px solid #3f3f46;
      }
      .dataTables_wrapper .dataTables_paginate .paginate_button {
          color: #a3e635 !important;
      }
    </style>
</head>
<body class="bg-zinc-900 text-zinc-200 min-h-screen">
    <div class="container mx-auto py-8">
        <h2 class="text-3xl font-bold mb-6 text-center text-lime-400">Painel de Gerenciamento de Usuários</h2>
        <div class="overflow-x-auto rounded-lg shadow-lg bg-zinc-800 ring-1 ring-zinc-700">
            <table id="tabela-usuarios" class="min-w-full table-auto text-sm">
                <thead class="bg-zinc-700">
                    <tr>
                        <th class="px-4 py-3 text-left font-semibold text-zinc-300">Email</th>
                        <th class="px-4 py-3 text-left font-semibold text-zinc-300">Status</th>
                        <th class="px-4 py-3 text-left font-semibold text-zinc-300">Ação</th>
                    </tr>
                </thead>
                <tbody>
                {% for user in users %}
                    <tr class="border-b border-zinc-700">
                        <td class="px-4 py-2">{{ user['email'] }}</td>
                        <td class="px-4 py-2">
                            <span class="font-semibold
                                {% if user['is_active'] == 2 %}text-cyan-400
                                {% elif user['is_active'] == 1 %}text-lime-400
                                {% else %}text-red-400{% endif %}">
                                {% if user['is_active'] == 2 %}
                                    Ilimitado
                                {% elif user['is_active'] == 1 %}
                                    Limitado
                                {% else %}
                                    Desativado
                                {% endif %}
                            </span>
                        </td>
                        <td class="px-4 py-2">
                            <div class="flex gap-2">
                                <!-- Botão Desativado -->
                                <form method="post" action="/toggle">
                                    <input type="hidden" name="id" value="{{ user['id'] }}">
                                    <input type="hidden" name="is_active" value="0">
                                    <button
                                        type="submit"
                                        class="px-3 py-1 rounded font-medium
                                            {% if user['is_active'] == 0 %}bg-red-700 border-2 border-white shadow-lg text-white{% else %}bg-red-700 hover:bg-red-800 text-white{% endif %}">
                                        Desativado
                                    </button>
                                </form>
                                <!-- Botão Limitado -->
                                <form method="post" action="/toggle">
                                    <input type="hidden" name="id" value="{{ user['id'] }}">
                                    <input type="hidden" name="is_active" value="1">
                                    <button
                                        type="submit"
                                        class="px-3 py-1 rounded font-medium
                                            {% if user['is_active'] == 1 %}bg-lime-600 border-2 border-white shadow-lg text-zinc-900{% else %}bg-lime-600 hover:bg-lime-700 text-zinc-900{% endif %}">
                                        Limitado
                                    </button>
                                </form>
                                <!-- Botão Ilimitado -->
                                <form method="post" action="/toggle">
                                    <input type="hidden" name="id" value="{{ user['id'] }}">
                                    <input type="hidden" name="is_active" value="2">
                                    <button
                                        type="submit"
                                        class="px-3 py-1 rounded font-medium
                                            {% if user['is_active'] == 2 %}bg-cyan-600 border-2 border-white shadow-lg text-zinc-900{% else %}bg-cyan-600 hover:bg-cyan-700 text-zinc-900{% endif %}">
                                        Ilimitado
                                    </button>
                                </form>
                            </div>
                        </td>

                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    <!-- jQuery + DataTables JS -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script>
      $(document).ready(function() {
        $('#tabela-usuarios').DataTable({
          "language": {
            "url": "//cdn.datatables.net/plug-ins/1.13.7/i18n/pt-BR.json"
          }
        });
      });
    </script>
</body>
</html>
